<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø¹Ø§Ù‹ Ù„Ù†Ø³Ø§Ø¹Ø¯ | Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Cairo', sans-serif; background-color: #f1f5f9; transition: all 0.3s; }
        .page { display: none; min-height: 100vh; }
        .page.active { display: flex; animation: slideUp 0.4s ease; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        .modal { display: none; position: fixed; inset: 0; background: rgba(15, 23, 42, 0.98); z-index: 100; align-items: center; justify-content: center; backdrop-filter: blur(15px); padding: 20px; }
        .modal.active { display: flex; }

        /* ØªØ°Ø¨Ø°Ø¨ Ø§Ù„Ø±Ø§Ø¯Ø§Ø± */
        .radar-wave {
            position: absolute;
            border: 3px solid #ef4444;
            border-radius: 50%;
            animation: ripple 2s linear infinite;
        }
        @keyframes ripple {
            0% { width: 100px; height: 100px; opacity: 1; }
            100% { width: 400px; height: 400px; opacity: 0; }
        }

        .emergency-flash { animation: flash-red 0.5s infinite; }
        @keyframes flash-red { 0%, 100% { background-color: #f1f5f9; } 50% { background-color: #fee2e2; } }

        /* Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø§Ù„Ø£ÙØ§ØªØ§Ø± */
        .finger { transition: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55); transform-origin: bottom center; }
        .hand-move { transition: transform 0.6s ease-in-out; }
        
        .eye-blink {
            animation: blink 4s infinite;
            transform-origin: center 72px;
        }
        @keyframes blink {
            0%, 96%, 98%, 100% { transform: scaleY(1); }
            97%, 99% { transform: scaleY(0.1); }
        }
    </style>
</head>
<body id="main-body">

    <!-- Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <div id="home" class="page active flex-col">
        <header class="p-6 bg-white shadow-sm flex flex-col md:flex-row justify-between items-center gap-4">
            <div class="flex items-center gap-4">
                <div class="bg-gradient-to-br from-blue-600 to-indigo-700 p-3 rounded-2xl text-white shadow-lg">ğŸ¤Ÿ</div>
                <div>
                    <h1 class="text-2xl font-black text-slate-800">Ù…Ø¹Ø§Ù‹ Ù„Ù†Ø³Ø§Ø¹Ø¯</h1>
                    <p class="text-xs text-slate-500 font-bold">Ø¨Ø¥Ø´Ø±Ø§Ù Ø§Ù„Ù…Ø¹Ù„Ù…Ø©: Ø£Ø­Ù„Ø§Ù… Ø§Ù„Ø³Ø§Ù„Ù…ÙŠ</p>
                </div>
            </div>
            <div class="text-right text-sm">
                <p class="font-bold text-slate-700">ØªÙ†ÙÙŠØ°: <span class="text-blue-600">ÙÙˆØ²ÙŠØ© Ø§Ù„Ø³ÙŠØ¯ ÙˆØ®ÙˆÙ„Ø© Ø§Ù„ØºØ§Ù…Ø¯ÙŠ</span></p>
                <p class="text-slate-500 text-xs">Ù…Ø³Ø§Ø¹Ø¯Ø© Ø®Ø§Ø±Ø¬ÙŠØ©: Ù…Ø±ÙŠØ§Ù† Ø±ØµØ±Øµ ÙˆØ³Ù…ÙŠØ© ÙØ®Ø±Ùˆ</p>
            </div>
        </header>

        <main class="p-8 max-w-6xl mx-auto w-full grid grid-cols-1 md:grid-cols-3 gap-8 mt-10">
            <!-- Ø±Ø§Ø¯Ø§Ø± Ø§Ù„Ø£ØµÙˆØ§Øª -->
            <div onclick="openModal('radar-modal')" class="bg-white p-10 rounded-[50px] shadow-xl hover:shadow-2xl transition-all cursor-pointer border-b-8 border-red-500 group">
                <div class="text-6xl mb-6 group-hover:scale-110 transition-transform">ğŸ””</div>
                <h3 class="text-2xl font-black">Ø±Ø§Ø¯Ø§Ø± Ø§Ù„Ø£ØµÙˆØ§Øª</h3>
                <p class="text-slate-500 mt-2 italic text-sm">ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø­Ø³Ø§Ø³Ø© Ø¬Ø¯Ø§Ù‹ Ù„Ù„Ø£ØµÙˆØ§Øª Ø§Ù„Ù…Ø­ÙŠØ·Ø© (Ø¨ÙˆÙ‚ØŒ ØµØ±Ø§Ø®ØŒ Ø¬Ø±Ø³)</p>
            </div>

            <!-- Ø§Ù„Ø£ÙØ§ØªØ§Ø± Ø§Ù„Ù…ØªØ±Ø¬Ù… -->
            <div onclick="openModal('avatar-modal')" class="bg-white p-10 rounded-[50px] shadow-xl hover:shadow-2xl transition-all cursor-pointer border-b-8 border-purple-600 group">
                <div class="text-6xl mb-6 group-hover:scale-110 transition-transform">ğŸ¤–</div>
                <h3 class="text-2xl font-black">Ø§Ù„Ø£ÙØ§ØªØ§Ø± Ø§Ù„Ø°ÙƒÙŠ</h3>
                <p class="text-slate-500 mt-2 italic text-sm">Ù…ØªØ±Ø¬Ù… ÙÙˆØ±ÙŠ ÙŠØ­ÙˆÙ„ Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ Ø­Ø±ÙƒØ§Øª Ø¥Ø´Ø§Ø±ÙŠØ© Ù…ØªÙ‚Ù†Ø©</p>
            </div>

            <!-- Ù…ØªØ±Ø¬Ù… Ø§Ù„ÙŠØ¯ -->
            <div onclick="openModal('cam-modal')" class="bg-white p-10 rounded-[50px] shadow-xl hover:shadow-2xl transition-all cursor-pointer border-b-8 border-blue-600 group">
                <div class="text-6xl mb-6 group-hover:scale-110 transition-transform">âœ‹</div>
                <h3 class="text-2xl font-black">Ù…ØªØ±Ø¬Ù… Ø§Ù„ÙŠØ¯ (AI)</h3>
                <p class="text-slate-500 mt-2 italic text-sm">ÙŠÙÙ‡Ù… Ø¥Ø´Ø§Ø±Ø§ØªÙƒ ÙˆÙŠØ­ÙˆÙ„Ù‡Ø§ Ù„Ù†Øµ ÙˆØµÙˆØª Ù…Ø³Ù…ÙˆØ¹</p>
            </div>
        </main>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø±Ø§Ø¯Ø§Ø± -->
    <div id="radar-modal" class="modal">
        <div class="bg-white p-10 rounded-[60px] w-full max-w-lg text-center shadow-2xl relative overflow-hidden">
            <button onclick="closeModals()" class="absolute top-8 left-8 text-3xl font-bold text-slate-300">Ã—</button>
            <h2 class="text-3xl font-black text-red-600 mb-6">Ù…Ø±Ø§Ù‚Ø¨ Ø§Ù„Ø£ØµÙˆØ§Øª Ø§Ù„Ø¢Ù…Ù†</h2>
            
            <div id="radar-visual" class="relative w-64 h-64 mx-auto mb-8 bg-slate-50 rounded-full flex items-center justify-center border-8 border-white shadow-inner">
                <div id="mic-icon" class="text-7xl z-10 transition-transform duration-100">ğŸ‘‚</div>
                <div id="waves-container"></div>
            </div>

            <div class="w-full bg-slate-100 h-3 rounded-full mb-8">
                <div id="db-bar" class="h-full bg-red-500 w-0 transition-all duration-75"></div>
            </div>

            <button onclick="toggleRadar()" id="radar-btn" class="w-full py-6 bg-red-600 text-white rounded-3xl font-black text-2xl shadow-lg active:scale-95 transition-all">Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©</button>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø£ÙØ§ØªØ§Ø± (Ù…Ø­Ø¯Ø«Ø© ÙˆÙ…Ø·ÙˆØ±Ø©) -->
    <div id="avatar-modal" class="modal">
        <div class="bg-white p-8 rounded-[60px] w-full max-w-4xl shadow-2xl relative">
            <button onclick="closeModals()" class="absolute top-8 left-8 text-3xl font-bold text-slate-300">Ã—</button>
            <div class="flex flex-col md:flex-row gap-8 items-center">
                
                <!-- Ø±Ø³Ù… Ø§Ù„Ø£ÙØ§ØªØ§Ø± Ø§Ù„Ù…Ø·ÙˆØ± -->
                <div class="w-full md:w-1/2 bg-gradient-to-t from-blue-50 to-slate-100 rounded-[45px] p-6 h-96 flex justify-center items-end border-4 border-slate-50 shadow-inner overflow-hidden">
                    <svg viewBox="0 0 200 200" class="w-full h-full drop-shadow-xl">
                        <defs>
                            <linearGradient id="skin" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" stop-color="#FFDBAC" />
                                <stop offset="100%" stop-color="#E0AC69" />
                            </linearGradient>
                            <linearGradient id="suit" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#1e293b" />
                                <stop offset="100%" stop-color="#0f172a" />
                            </linearGradient>
                        </defs>
                        
                        <!-- Ø§Ù„Ø¬Ø³Ù… / Ø§Ù„Ø£ÙƒØªØ§Ù -->
                        <path d="M20,200 Q100,110 180,200" fill="url(#suit)" />
                        
                        <!-- Ø§Ù„Ø±Ø£Ø³ -->
                        <circle cx="100" cy="80" r="45" fill="url(#skin)" />
                        
                        <!-- Ø§Ù„Ø´Ø¹Ø± -->
                        <path d="M55,80 Q100,10 145,80 Q100,35 55,80" fill="#333" />
                        
                        <!-- Ø§Ù„Ø¹ÙŠÙˆÙ† (Ù…Ø¹ Ø§Ù„Ø±Ù…Ø´) -->
                        <g class="eye-blink">
                            <circle cx="82" cy="72" r="5" fill="#222" />
                            <circle cx="118" cy="72" r="5" fill="#222" />
                            <!-- Ù„Ù…Ø¹Ø© Ø§Ù„Ø¹ÙŠÙ† -->
                            <circle cx="80" cy="70" r="2" fill="#fff" />
                            <circle cx="116" cy="70" r="2" fill="#fff" />
                        </g>

                        <!-- Ø§Ù„ÙÙ… -->
                        <path id="av-mouth" d="M85,95 Q100,105 115,95" stroke="#222" stroke-width="2.5" stroke-linecap="round" fill="none" />

                        <!-- Ø§Ù„ÙŠØ¯ Ø§Ù„Ù…Ø·ÙˆØ±Ø© -->
                        <g id="av-hand-group" class="hand-move" transform="translate(100, 180)">
                            <path d="M-22,0 Q0,-15 22,0 L18,40 L-18,40 Z" fill="url(#skin)" />
                            <!-- Ø§Ù„Ø£ØµØ§Ø¨Ø¹ -->
                            <rect id="f-index" class="finger" x="-20" y="-40" width="8" height="40" rx="4" fill="url(#skin)" />
                            <rect id="f-middle" class="finger" x="-8" y="-45" width="8" height="45" rx="4" fill="url(#skin)" />
                            <rect id="f-ring" class="finger" x="4" y="-42" width="8" height="42" rx="4" fill="url(#skin)" />
                            <rect id="f-pinky" class="finger" x="16" y="-35" width="8" height="35" rx="4" fill="url(#skin)" />
                            <rect id="f-thumb" class="finger" x="24" y="-12" width="28" height="9" rx="4.5" fill="url(#skin)" transform-origin="24 0" />
                        </g>
                    </svg>
                </div>

                <!-- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… -->
                <div class="w-full md:w-1/2">
                    <h2 class="text-3xl font-black text-purple-700 mb-2">Ø§Ù„Ø£ÙØ§ØªØ§Ø± Ø§Ù„Ù…ØªØ±Ø¬Ù…</h2>
                    <p class="text-slate-400 mb-6">Ø¬Ø±Ø¨: (Ø£Ø­Ø¨ÙƒØŒ Ø´ÙƒØ±Ø§Ù‹ØŒ Ù…Ø§Ø¡ØŒ ÙƒÙŠÙ Ø­Ø§Ù„ÙƒØŒ ØµÙ„Ø§Ø©)</p>
                    <input type="text" id="av-input" placeholder="Ø§ÙƒØªØ¨ ÙƒÙ„Ù…ØªÙƒ Ù‡Ù†Ø§..." class="w-full p-6 bg-slate-100 rounded-3xl mb-4 border-none outline-none focus:ring-4 focus:ring-purple-200 text-2xl font-black text-center">
                    <button onclick="animateAvatar()" class="w-full py-6 bg-purple-600 text-white rounded-3xl font-black text-xl shadow-lg hover:scale-105 transition-transform">ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø­Ø±ÙƒØ©</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ (ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„ÙØ¹Ù„ÙŠ) -->
    <div id="cam-modal" class="modal">
        <div class="bg-white p-8 rounded-[60px] w-full max-w-2xl text-center relative shadow-2xl">
            <button onclick="closeModals()" class="absolute top-8 left-8 text-3xl font-bold text-slate-300 z-50">Ã—</button>
            <h2 class="text-2xl font-black mb-4">Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø¹Ø¨Ø± Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ (ØªØ¹Ù…Ù„ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ)</h2>
            <div class="relative aspect-video bg-black rounded-[40px] overflow-hidden border-8 border-slate-100 shadow-xl">
                <video id="v-input" autoplay playsinline class="w-full h-full object-cover transform -scale-x-100"></video>
                <canvas id="c-output" class="absolute inset-0 w-full h-full transform -scale-x-100"></canvas>
            </div>
            <div id="gesture-res" class="mt-6 p-6 bg-slate-50 rounded-3xl text-3xl font-black text-slate-400 border-2 border-slate-100 transition-colors duration-300">
                Ø§Ù†ØªØ¸Ø§Ø± Ø¥Ø´Ø§Ø±Ø© Ø§Ù„ÙŠØ¯...
            </div>
            <button id="start-cam-btn" onclick="initCamera()" class="w-full mt-4 py-4 bg-blue-600 text-white rounded-2xl font-bold shadow-lg hover:bg-blue-700 transition-colors">Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ù„ÙŠÙ„ ÙˆØ§Ù„ØªØ±Ø¬Ù…Ø©</button>
        </div>
    </div>

    <script>
        function openModal(id) { document.getElementById(id).classList.add('active'); }
        function closeModals() { 
            document.querySelectorAll('.modal').forEach(m => m.classList.remove('active'));
            if(window.aCtx) window.aCtx.close();
            document.getElementById('main-body').classList.remove('emergency-flash');
        }

        // --- Ù…Ø­Ø±Ùƒ Ø±Ø§Ø¯Ø§Ø± Ø§Ù„Ø£ØµÙˆØ§Øª ---
        let radarActive = false;
        async function toggleRadar() {
            if(radarActive) { location.reload(); return; }
            radarActive = true;
            document.getElementById('radar-btn').innerText = "Ø§Ù„Ø±Ø§Ø¯Ø§Ø± ÙŠØ¹Ù…Ù„ Ø§Ù„Ø¢Ù† (Ø§Ø¶ØºØ· Ù„Ù„Ø¥ÙŠÙ‚Ø§Ù)";
            
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                window.aCtx = new (window.AudioContext || window.webkitAudioContext)();
                const analyser = window.aCtx.createAnalyser();
                const source = window.aCtx.createMediaStreamSource(stream);
                source.connect(analyser);
                analyser.fftSize = 128;
                const buffer = new Uint8Array(analyser.frequencyBinCount);

                const icon = document.getElementById('mic-icon');
                const bar = document.getElementById('db-bar');
                const container = document.getElementById('waves-container');
                const body = document.getElementById('main-body');

                function loop() {
                    analyser.getByteFrequencyData(buffer);
                    let sum = 0; for(let x of buffer) sum += x;
                    let vol = sum / buffer.length;

                    bar.style.width = Math.min(vol * 2.5, 100) + "%";
                    icon.style.transform = `scale(${1 + vol/100})`;

                    if(vol > 20) { 
                        icon.innerText = "ğŸš¨";
                        body.classList.add('emergency-flash');
                        const w = document.createElement('div');
                        w.className = 'radar-wave';
                        container.appendChild(w);
                        setTimeout(() => w.remove(), 2000);
                        if(navigator.vibrate) navigator.vibrate(200);
                    } else {
                        icon.innerText = "ğŸ‘‚";
                        body.classList.remove('emergency-flash');
                    }
                    if(radarActive) requestAnimationFrame(loop);
                }
                loop();
            } catch(e) { alert("ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…Ø§ÙŠÙƒØ±ÙˆÙÙˆÙ†"); }
        }

        // --- Ù…Ø­Ø±Ùƒ Ø§Ù„Ø£ÙØ§ØªØ§Ø± (Ù…Ø·ÙˆØ±) ---
        let resetTimeout;
        function animateAvatar() {
            clearTimeout(resetTimeout);
            const input = document.getElementById('av-input').value.trim();
            const hand = document.getElementById('av-hand-group');
            const mouth = document.getElementById('av-mouth');
            const fngs = ['f-index', 'f-middle', 'f-ring', 'f-pinky', 'f-thumb'];

            // ØªØµÙÙŠØ± Ø§Ù„ÙˆØ¶Ø¹ÙŠØ©
            fngs.forEach(f => {
                const el = document.getElementById(f);
                el.style.transform = "scaleY(1) rotate(0deg)";
            });
            hand.style.transform = "translate(100px, 180px) rotate(0deg)"; // Ù…ÙƒØ§Ù† Ø§Ù„ÙŠØ¯ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„

            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ø±ÙƒØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ù…Ø©
            if(input.includes("Ø£Ø­Ø¨Ùƒ")) {
                document.getElementById('f-middle').style.transform = "scaleY(0.2)";
                document.getElementById('f-ring').style.transform = "scaleY(0.2)";
                hand.style.transform = "translate(100px, 120px) rotate(-15deg)";
            } else if(input.includes("Ø´ÙƒØ±Ø§") || input.includes("Ø´ÙƒØ±Ø§Ù‹")) {
                hand.style.transform = "translate(100px, 100px)"; // ÙŠØ±ÙØ¹ ÙŠØ¯Ù‡ Ù„Ù„Ø£Ø¹Ù„Ù‰
                setTimeout(() => hand.style.transform = "translate(100px, 140px)", 500); // ÙŠÙ†Ø²Ù„Ù‡Ø§ Ù‚Ù„ÙŠÙ„Ø§Ù‹ ÙƒØ­Ø±ÙƒØ© Ø´ÙƒØ±
            } else if(input.includes("Ù…Ø§Ø¡")) {
                document.getElementById('f-index').style.transform = "scaleY(0.2)";
                document.getElementById('f-middle').style.transform = "scaleY(0.2)";
                document.getElementById('f-ring').style.transform = "scaleY(0.2)";
                hand.style.transform = "translate(100px, 110px)"; // ÙŠÙ‚Ø±Ø¨Ù‡Ø§ Ù…Ù† ÙÙ…Ù‡
            } else if(input.includes("Ø­Ø§Ù„Ùƒ") || input.includes("ÙƒÙŠÙ")) {
                document.getElementById('f-thumb').style.transform = "rotate(-45deg)";
                hand.style.transform = "translate(120px, 130px)"; // ÙŠØ±ÙØ¹Ù‡Ø§ ÙˆÙŠÙ…ÙŠÙ„Ù‡Ø§
            } else if(input.includes("ØµÙ„Ø§Ø©")) {
                hand.style.transform = "translate(100px, 110px) rotate(-90deg)"; // ÙŠÙ…ÙŠÙ„ Ø§Ù„ÙŠØ¯ Ø£ÙÙ‚ÙŠØ§Ù‹
            } else {
                // Ø¥Ø°Ø§ Ù„Ù… ÙŠØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ù…Ø©ØŒ ÙŠÙ„ÙˆØ­ Ø¨ÙŠØ¯Ù‡
                hand.style.transform = "translate(100px, 120px) rotate(15deg)";
            }

            // ØªØ­Ø±ÙŠÙƒ Ø§Ù„ÙÙ… ÙˆØ§Ù„Ù†Ø·Ù‚
            mouth.setAttribute('d', 'M85,100 Q100,115 115,100'); // ÙÙ… Ù…ÙØªÙˆØ­
            const s = new SpeechSynthesisUtterance(input || "Ù„Ù… Ø£ÙÙ‡Ù… Ø§Ù„ÙƒÙ„Ù…Ø©");
            s.lang = 'ar-SA';
            s.onend = () => mouth.setAttribute('d', 'M85,95 Q100,105 115,95'); // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ÙÙ…
            window.speechSynthesis.speak(s);

            // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ÙŠØ¯ Ù„ÙˆØ¶Ø¹Ù‡Ø§ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ Ø¨Ø¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø¨Ù€ 3 Ø«ÙˆØ§Ù†ÙŠ
            resetTimeout = setTimeout(() => {
                fngs.forEach(f => document.getElementById(f).style.transform = "scaleY(1) rotate(0deg)");
                hand.style.transform = "translate(100px, 180px) rotate(0deg)";
            }, 3000);
        }

        // --- Ù…ØªØ±Ø¬Ù… Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ AI (ØªÙ… Ø¥ØµÙ„Ø§Ø­Ù‡ ÙˆØªØ·ÙˆÙŠØ±Ù‡) ---
        let camActive = false;
        async function initCamera() {
            if(camActive) return;
            camActive = true;
            document.getElementById('start-cam-btn').innerText = "Ø¬Ø§Ø±ÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§...";
            
            const video = document.getElementById('v-input');
            const canvas = document.getElementById('c-output');
            const ctx = canvas.getContext('2d');
            const res = document.getElementById('gesture-res');

            const hands = new Hands({locateFile: (f) => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${f}`});
            hands.setOptions({
                maxNumHands: 1, 
                modelComplexity: 1,
                minDetectionConfidence: 0.6,
                minTrackingConfidence: 0.6
            });
            
            hands.onResults(results => {
                ctx.save();
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                if(results.multiHandLandmarks && results.multiHandLandmarks.length > 0) {
                    const landmarks = results.multiHandLandmarks[0];
                    
                    // Ø±Ø³Ù… Ø§Ù„Ù…ÙØ§ØµÙ„ ÙˆØ§Ù„Ø®Ø·ÙˆØ· Ø¨Ø´ÙƒÙ„ Ø³Ù„ÙŠÙ…!
                    window.drawConnectors(ctx, landmarks, window.HAND_CONNECTIONS, {color: '#ffffff', lineWidth: 4});
                    window.drawLandmarks(ctx, landmarks, {color: '#3b82f6', lineWidth: 2, radius: 4});
                    
                    // --- Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø±ÙƒØ§Øª (AI Logic) ---
                    // Ù†Ø­Ø³Ø¨ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø£ØµØ§Ø¨Ø¹ Ù…ÙØªÙˆØ­Ø© Ø£Ùˆ Ù…ØºÙ„Ù‚Ø© Ø¨Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø¹Ù„ÙŠØ§ ÙˆØ§Ù„Ø³ÙÙ„Ù‰
                    const isIndexOpen = landmarks[8].y < landmarks[6].y;
                    const isMiddleOpen = landmarks[12].y < landmarks[10].y;
                    const isRingOpen = landmarks[16].y < landmarks[14].y;
                    const isPinkyOpen = landmarks[20].y < landmarks[18].y;

                    let gesture = "Ø£Ù†Ø§ Ø£Ø±Ø§Ù‚Ø¨ ÙŠØ¯Ùƒ...";
                    res.className = "mt-6 p-6 rounded-3xl text-3xl font-black transition-colors duration-300 bg-blue-100 text-blue-800 border-2 border-blue-200";

                    // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø´ÙƒÙ„ Ù„Ø¥Ø®Ø±Ø§Ø¬ Ø§Ù„ÙƒÙ„Ù…Ø©
                    if (isIndexOpen && isMiddleOpen && isRingOpen && isPinkyOpen) {
                        gesture = "ğŸ‘‹ Ù…Ø±Ø­Ø¨Ø§Ù‹ (Ø³Ù„Ø§Ù…)";
                    } else if (!isIndexOpen && !isMiddleOpen && !isRingOpen && !isPinkyOpen) {
                        gesture = "âœŠ Ù‚Ø¨Ø¶Ø© (ØªÙˆÙ‚Ù/Ù‚ÙˆØ©)";
                    } else if (isIndexOpen && isMiddleOpen && !isRingOpen && !isPinkyOpen) {
                        gesture = "âœŒï¸ Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù†ØµØ± (Ø§Ù„Ø³Ù„Ø§Ù…)";
                    } else if (isIndexOpen && !isMiddleOpen && !isRingOpen && !isPinkyOpen) {
                        gesture = "â˜ï¸ ÙˆØ§Ø­Ø¯ (Ø§Ù†ØªØ¨Ø§Ù‡)";
                    } else if (!isIndexOpen && !isMiddleOpen && !isRingOpen && isPinkyOpen) {
                        gesture = "ğŸ¤™ Ø±Ø§Ø¦Ø¹ (Ù…Ù…ØªØ§Ø²)";
                    }

                    res.innerText = gesture;
                } else {
                    res.innerText = "Ø§Ù†ØªØ¸Ø§Ø± Ø¥Ø´Ø§Ø±Ø© Ø§Ù„ÙŠØ¯...";
                    res.className = "mt-6 p-6 bg-slate-50 rounded-3xl text-3xl font-black text-slate-400 border-2 border-slate-100 transition-colors duration-300";
                }
                ctx.restore();
            });

            try {
                const stream = await navigator.mediaDevices.getUserMedia({video: true});
                video.srcObject = stream;
                
                // ØªØ­Ø¯ÙŠØ« Ù…Ù‚Ø§Ø³Ø§Øª Ø§Ù„ÙƒØ§Ù†ÙØ§Ø³ Ù„ØªØªØ·Ø§Ø¨Ù‚ Ù…Ø¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
                video.onloadedmetadata = () => {
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                };

                const cam = new Camera(video, {
                    onFrame: async () => {
                        await hands.send({image: video});
                    },
                    width: 640,
                    height: 480
                });
                cam.start();
                document.getElementById('start-cam-btn').innerText = "Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ØªØ¹Ù…Ù„ Ø¨Ù†Ø¬Ø§Ø­ ğŸŸ¢";
                document.getElementById('start-cam-btn').classList.replace('bg-blue-600', 'bg-green-500');
            } catch (err) {
                alert("ØªØ¹Ø°Ø± Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„ÙƒØ§Ù…ÙŠØ±Ø§ØŒ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¹Ø·Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©.");
                document.getElementById('start-cam-btn').innerText = "ÙØ´Ù„ ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§";
            }
        }
    </script>
</body>
</html>